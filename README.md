# AI-Refinery: Chechen Language Data Cleaning

Интеллектуальная очистка данных чеченского языка (Noxchiyn Mott) с использованием OpenAI API.

## Описание

Этот проект автоматически исправляет ошибки OCR в чеченско-русском разговорнике, используя возможности искусственного интеллекта OpenAI.

### Основные возможности

- Автоматическое исправление палочки (1) в чеченском языке
- Исправление окончаний слов (Са" → Сан, Хьа" → Хьан)
- Исправление грамматических ошибок OCR
- Обработка больших файлов по частям (chunks)
- Сохранение прогресса (можно прервать и продолжить)
- Прогресс-бар в консоли
- Автоматические повторы при ошибках API

## Установка

### 1. Установите зависимости

```bash
npm install
```

### 2. Настройте API ключ

Создайте файл `.env` на основе `.env.example`:

```bash
cp .env.example .env
```

Откройте `.env` и добавьте ваш OpenAI API ключ:

```env
OPENAI_API_KEY=sk-your-actual-api-key-here
OPENAI_MODEL=gpt-4o-mini
```

Получить API ключ можно на https://platform.openai.com/api-keys

### 3. Подготовьте входной файл

Убедитесь, что файл `dirty_phrasebook.txt` находится в корневой директории проекта.

## Использование

### Запуск скрипта

```bash
npm run refine
```

Скрипт автоматически:
1. Читает `dirty_phrasebook.txt`
2. Разбивает на блоки по 20 строк
3. Отправляет каждый блок в OpenAI API
4. Сохраняет результат в `clean_database.json`
5. Показывает прогресс в консоли

### Возобновление после прерывания

Если скрипт был прерван, просто запустите его снова:

```bash
npm run refine
```

Он автоматически продолжит с того места, где остановился.

## Конфигурация

Настройки в `.env`:

| Параметр | Описание | По умолчанию |
|----------|----------|--------------|
| `OPENAI_API_KEY` | Ваш API ключ OpenAI | (обязательно) |
| `OPENAI_MODEL` | Модель OpenAI (`gpt-4o` или `gpt-4o-mini`) | `gpt-4o-mini` |
| `CHUNK_SIZE` | Количество строк в одном блоке | `20` |
| `REQUEST_DELAY_MS` | Задержка между запросами (мс) | `500` |
| `MAX_RETRIES` | Максимум повторов при ошибке | `3` |

### Выбор модели

- **gpt-4o-mini**: Быстрее и дешевле, подходит для большинства случаев
- **gpt-4o**: Более точный, для сложных случаев

## Формат входных данных

Файл `dirty_phrasebook.txt` должен содержать строки в формате:

```
Русская фраза | Чеченская фраза (с ошибками)
```

Пример:
```
Привет | Маршалла хьа де
Мой дом | Са" цlа
```

## Формат выходных данных

Файл `clean_database.json` содержит массив объектов:

```json
[
  {
    "ru": "Привет",
    "ce": "Маршалла хьа де"
  },
  {
    "ru": "Мой дом",
    "ce": "Сан цlа"
  }
]
```

## Структура проекта

```
.
├── refine_data.ts          # Основной скрипт
├── dirty_phrasebook.txt    # Входной файл (с ошибками)
├── clean_database.json     # Выходной файл (исправленный)
├── package.json            # Зависимости
├── tsconfig.json           # Конфигурация TypeScript
├── .env.example            # Пример переменных окружения
├── .env                    # Ваши переменные окружения (не в git)
└── README.md               # Этот файл
```

## Примеры исправлений

| Ошибка OCR | Исправлено |
|------------|------------|
| `Са"` | `Сан` (Мой) |
| `Хьа"` | `Хьан` (Твой) |
| `хуй1ла` | `хуьйла` |
| `вой1а` | `войла` |
| `глаза` → `гIа:за` | `гIаза` |

## Устранение неполадок

### Ошибка: OPENAI_API_KEY not found

Убедитесь, что:
1. Файл `.env` существует
2. В нем есть строка `OPENAI_API_KEY=sk-...`
3. Ключ действителен

### Ошибка: Rate limit exceeded

Увеличьте `REQUEST_DELAY_MS` в `.env`:

```env
REQUEST_DELAY_MS=1000
```

### Слишком медленная обработка

Используйте меньший размер блоков или более быструю модель:

```env
OPENAI_MODEL=gpt-4o-mini
CHUNK_SIZE=15
```

## Стоимость

Примерная стоимость обработки (зависит от размера файла):

- **gpt-4o-mini**: ~$0.15 за 180 страниц
- **gpt-4o**: ~$1.50 за 180 страниц

Актуальные цены: https://openai.com/api/pricing/

## Лицензия

MIT

## Поддержка

Если у вас возникли вопросы или проблемы, создайте issue в репозитории.
